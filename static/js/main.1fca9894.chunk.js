(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{74:function(e,t,n){e.exports=n(97)},79:function(e,t,n){},81:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(9),o=n.n(i),c=(n(79),n(49)),l=n(14),u=n.n(l),s=n(27),f=n(20),p=n(28),h=n(65),d=n(64),m=n(131),v=n(134),g=n(148),k=n(136),y=n(137),b=n(138),E=n(150),w=n(141),j=n(142),O=n(143),x=n(99),C=n(135),S=n(146),P=n(63),A=n(130),I=n(45),T=n(139),N=n(140),K=n(144),H=n(145),J=n(147),M=(n(81),"https://furigana-lychee.herokuapp.com/"),W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4,a=!1;return new Promise((function(r,i){var o=setTimeout((function(){a=!0,i(new Error("Fetch timeout"))}),n);fetch(e,t).then((function(e){clearTimeout(o),a||r(e)})).catch((function(e){a||i(e)}))}))},B=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,null,[{key:"wakeUpServer",value:function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:W(M,null,5e3).then((function(e){})).catch((function(e){return console.error(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"query",value:function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(M,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({text:t})}).then((function(e){return e.json()}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"report",value:function(){var e=Object(s.a)(u.a.mark((function e(t,n,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(M,"/report"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({text:"".concat(t,": `").concat(n,"`\n```").concat(a,"```")})}).then((function(e){return e.text()}));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()}]),e}(),q=function e(){Object(f.a)(this,e)};q.isKanji=function(e){var t=e.charCodeAt(0);return t>=19968&&t<=40959||"\u3005"===e||"\u30f6"===e||"\u30f5"===e},q.isHiragana=function(e){var t=e.charCodeAt(0);return t>=12353&&t<=12438},q.isAlpha=function(e){var t=e.charCodeAt(0);return t>=65&&t<=122},q.isNumber=function(e){var t=e.charCodeAt(0);return t>=48&&t<=57},q.isPureAlpha=function(e){for(var t=0;t<e.length;t++)if(!q.isAlpha(e[t]))return!1;return!0},q.isPureHiragana=function(e){for(var t=0;t<e.length;t++)if(!q.isHiragana(e[t]))return!1;return!0},q.isPureKanji=function(e){for(var t=0;t<e.length;t++)if(!q.isKanji(e[t]))return!1;return!0},q.hasKanji=function(e){for(var t=0;t<e.length;t++)if(q.isKanji(e[t]))return!0;return!1};var V=q,F=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,null,[{key:"format",value:function(e,t){return e===t||0===t.length||V.isPureAlpha(e)?e:this.align(e,t)}},{key:"divideSurface",value:function(e){for(var t=[],n=[e[0]],a=1;a<e.length;a++)!V.isHiragana(e[a])===!V.isHiragana(e[a-1])?n.push(e[a]):(t.push(n.join("")),n=[e[a]]);return t.push(n.join("")),t}},{key:"align",value:function(e,t){var n=this.divideSurface(e),a=Array(n.length).length;if(1===a)return"".concat(e,"(").concat(t,")");if(2===a){if(V.isKanji(n[0][0])){var r=t.lastIndexOf(n[1]);return"".concat(n[0],"(").concat(t.substr(0,r),")").concat(n[1])}var i=n[0].length;return"".concat(n[0]).concat(n[1],"(").concat(t.substr(i),")")}if(3===a){if(V.isKanji(n[0][0])){var o=t.slice(1,-1).indexOf(n[1])+1;return"".concat(n[0],"(").concat(t.substr(0,o),")").concat(n[1]).concat(n[2],"(").concat(t.substr(o+n[1].length),")")}var c=t.slice(n[0].length).slice(0,-n[2].length);return"".concat(n[0]).concat(n[1],"(").concat(c).concat(n[2],")")}if(4===a&&V.isKanji(n[0][0])){var l=t.slice(0,-n[3].length),u=this.align(n.slice(0,3).join(""),l);return u+=n[3]}}}]),e}(),D=n(58),U=n.n(D),z=Object(P.a)({palette:{primary:{main:A.a[700]}}}),L=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(f.a)(this,n),(e=t.call(this)).handleChange=function(t){e.setState({source:t.target.value})},e.query=Object(s.a)(u.a.mark((function t(){var n,a,r,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0===e.state.source.length?[e.placeholder]:e.state.source.split("\n"),a=[],r=0;case 3:if(!(r<n.length)){t.next=16;break}if(0!==n[r].length){t.next=8;break}a.push([]),t.next=13;break;case 8:return t.next=10,B.query(n[r]);case 10:i=(i=t.sent).map((function(e){var t=e["\u51fa\u73fe\u5f62"][1],n=e["\u8a9e\u5f59\u7d20"];("\u56fa\u6709\u540d\u8a5e"===e["\u54c1\u8a5e"][1]&&V.hasKanji(e["\u57fa\u672c\u5f62"][0])&&(n=e["\u57fa\u672c\u5f62"][0]),e["\u8a9e\u5f59\u7d20"].indexOf("-")>0)&&(t=e["\u8a9e\u5f59\u7d20"].split("-")[1],n=e["\u8a9e\u5f59\u7d20"].split("-")[0]);return e.okurigana=F.format(e.surface,t),e.dictionary=n,e})),a.push(i);case 13:r++,t.next=3;break;case 16:e.setState({paragraph:a});case 17:case"end":return t.stop()}}),t)}))),e.select=function(){var t=Object(s.a)(u.a.mark((function t(n,a){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==n&&void 0!==a){t.next=2;break}return t.abrupt("return");case 2:e.selectedPointer=[n,a],r=e.state.paragraph[n][a],e.setState({wordInfo:r,dialogOpen:!0}),window.history.pushState({noBackExitsApp:!0},"");case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.format=function(t,n,a){var i="clickable";return t.bookmark&&(i+=" bookmark"),r.a.createElement("div",{key:a,className:i,style:{display:"inline-block",fontSize:"14pt"},onClick:function(t){e.select(n,a)}},e.okuriganToFurigana(t.okurigana))},e.okuriganToFurigana=function(e){if(!e)return[];for(var t="",n="",a=!1,i=[],o=0;o<e.length;o++){var c=e[o];"("===c?a=!0:")"===c?(i.push([t,n]),n="",t="",a=!1):a?n+=c:t.length>0&&!V.isHiragana(c)&&V.isHiragana(t.substr(-1))?(i.push([t,n]),n="",t=c):t+=c}return i.push([t,n]),i.map((function(e,t){var n=e[0],a=e[1];return r.a.createElement("div",{key:t,style:{display:"inline-block"}},r.a.createElement("div",{className:"furigana"},a),r.a.createElement("div",{className:"surface"},n))}))},e.state={source:"",paragraph:[],wordInfo:null,dialogOpen:!1},e.placeholder="\u3053\u3053\u3067\u6587\u7ae0\u3092\u5165\u529b\u3057\u3066\u53f3\u4e0b\u306e\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044",e.selectedPointer=[0,0],B.wakeUpServer(),e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("popstate",(function(t){e.state.dialogOpen?e.setState({dialogOpen:!1}):window.history.back()}))}},{key:"render",value:function(){for(var e=this,t=[],n=function(n){var a=e.state.paragraph[n].map((function(t,a){return e.format(t,n,a)}));t.push(a)},a=0;a<this.state.paragraph.length;a++)n(a);var i="";return U.a.parse(window.location.search).preview&&(i="a4"),r.a.createElement(m.a,{fixed:!0,style:{display:"flex",flexDirection:"column"}},r.a.createElement(v.a,{theme:z},r.a.createElement("form",{noValidate:!0,autoComplete:"off",style:{marginTop:24}},r.a.createElement(g.a,{placeholder:this.placeholder,fullWidth:!0,label:"\u6587\u7ae0\u5165\u529b",multiline:!0,rows:6,variant:"outlined",value:this.state.source,onChange:this.handleChange,InputProps:{startAdornment:r.a.createElement(k.a,{position:"start"})}}),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(y.a,{color:"primary",onClick:function(t){return e.query()}},"\u632f\u308a\u4eee\u540d"))),r.a.createElement("div",{className:["content",i].join(" ")},r.a.createElement("div",null,t.map((function(e){return r.a.createElement("div",{key:e,className:"paragraph"},e)})))),r.a.createElement(G,{wordInfo:this.state.wordInfo,dialogOpen:this.state.dialogOpen,onClose:function(){return e.setState({dialogOpen:!1})},addBookmark:function(t){var n=e.state.wordInfo;n.bookmark=t,e.setState({wordInfo:n})},onSave:function(t,n){var a=e.state.wordInfo;if(0!==t.length&&t!==a.okurigana){var r=e.selectedPointer[0],i=e.selectedPointer[1],o=Math.max(i-1,0),c=Math.min(i+2,e.state.paragraph[r].length);B.report("\u9001\u308a\u4eee\u540d\u4fee\u6b63",t,JSON.stringify(e.state.paragraph[r].slice(o,c)))}if(0!==n.length&&n!==a.dictionary){var l=e.selectedPointer[0],u=e.selectedPointer[1],s=Math.max(u-1,0),f=Math.min(u+2,e.state.paragraph[l].length);B.report("\u5b57\u5178\u4fee\u6b63",n,JSON.stringify(e.state.paragraph[l].slice(s,f)))}a.okurigana=t,a.dictionary=n,e.setState({wordInfo:a,paragraph:e.state.paragraph,dialogOpen:!1})}})))}}]),n}(r.a.Component),R=r.a.forwardRef((function(e,t){return r.a.createElement(b.a,Object.assign({direction:"up",ref:t},e))})),$=function(e){for(var t=0,n=0;n<e.length;n++)if("("===e[n]){if(1!==++t)break}else")"===e[n]&&t--;return 0===t};function G(e){var t=e.wordInfo,n=r.a.useState(""),a=Object(c.a)(n,2),i=a[0],o=a[1],l=r.a.useState(""),u=Object(c.a)(l,2),s=u[0],f=u[1];if(null==t)return r.a.createElement("div",null);var p=r.a.createElement(T.a,null);return t.bookmark&&(p=r.a.createElement(N.a,null)),r.a.createElement(E.a,{fullScreen:!0,open:e.dialogOpen,onExited:function(e){o(""),f("")},TransitionComponent:R},r.a.createElement(w.a,{position:"relative"},r.a.createElement(j.a,null,r.a.createElement(O.a,{edge:"start",color:"inherit",onClick:function(){return e.onClose()},"aria-label":"close"},r.a.createElement(K.a,null)),r.a.createElement(x.a,{variant:"h6",style:{flex:1}},t.surface),r.a.createElement(O.a,{edge:"start",color:"inherit",onClick:function(){return e.addBookmark(!t.bookmark)},"aria-label":"close"},p),r.a.createElement(O.a,{edge:"start",color:"inherit",onClick:function(){return window.open("https://www.weblio.jp/content/".concat(s||t.dictionary))},"aria-label":"close"},r.a.createElement(H.a,null)))),r.a.createElement(m.a,{fixed:!0},r.a.createElement(C.a,{component:"nav"},r.a.createElement(S.a,null,r.a.createElement(g.a,{fullWidth:!0,label:"\u6d3b\u7528",disabled:!0,defaultValue:"".concat(t["\u54c1\u8a5e"][0],", ").concat(t["\u6d3b\u7528\u578b"][0])})),r.a.createElement(S.a,null,r.a.createElement(g.a,{error:!$(i),helperText:$(i)?" ":"\u683c\u5f0f\u932f\u8aa4",fullWidth:!0,label:"\u9001\u308a\u4eee\u540d",defaultValue:t.okurigana,onChange:function(e){return o(e.target.value)},InputProps:{endAdornment:r.a.createElement(X,{visibility:!1,onClick:function(){}})}})),r.a.createElement(S.a,null,r.a.createElement(g.a,{fullWidth:!0,label:"\u8f9e\u66f8",defaultValue:t.dictionary,onChange:function(e){return f(e.target.value)},InputProps:{endAdornment:r.a.createElement(X,{visibility:!1,onClick:function(){}})}})),r.a.createElement(S.a,{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(y.a,{color:"primary",onClick:function(){$(i)&&e.onSave(i||t.okurigana,s||t.dictionary)}},"\u66f4\u65b0")))))}var Q=Object(P.a)({palette:{secondary:{main:I.a[500]}}});function X(e){return r.a.createElement(v.a,{theme:Q},r.a.createElement(k.a,{position:"end"},e.visibility?r.a.createElement(y.a,{onClick:e.onClick,color:"secondary",startIcon:r.a.createElement(J.a,null)},"\u56de\u5831\u932f\u8aa4"):r.a.createElement("div",null)))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(L,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[74,1,2]]]);
//# sourceMappingURL=main.1fca9894.chunk.js.map